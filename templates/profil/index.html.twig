{% extends 'base.html.twig' %}

{% block title %}Profil{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script>
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader();
                reader.onload = function(e) {
                    $('#imagePreview').css('background-image', 'url('+e.target.result +')');
                    $('#imagePreview').hide();
                    $('#imagePreview').fadeIn(650);
                }
                reader.readAsDataURL(input.files[0]);
            }
        }
        $(document).ready(function () {
            $("#imageUpload").change(function() {
                readURL(this);
            });
        })
    </script>
{% endblock %}

{% block body %}
<div class="profil_wrapper">
    <h1 class="hello_user">Bonjour {{ user.username }} !</h1>

    <div class="container_avatar">
        <h1 class="title_avatar">Avatar</h1>
        <div class="avatar-upload">
            {{ form_start(profilForm) }}
                <div class="avatar-edit">
                    {# <div>
                        <img src="{{ vich_uploader_asset(user, 'imageFile') }}">
                    </div> #}
                    {{ form_row(profilForm.imageFile) }}
                    {{ form_row(profilForm.username) }}
                    {# <input name="newImg" type='file' id="imageUpload" accept=".png, .jpg, .jpeg" />
                    <label class="label_imageUpload" "imageUpload"></label> #}
                </div>
                <div class="avatar-preview">
                    <img src="{{ asset('img/users/' ~ user.imageName) }}" alt="">
                    <div id="imagePreview" style="background-image: url({{ asset('img/users/' ~ user.imageName) }});">
                    </div>
                </div>
                <button class="button_crud">{{ button_label|default('Enregistrer') }}</button>
            {{ form_end(profilForm) }}
        </div>
    </div>

    {% if is_granted('ROLE_ADMIN') %}
        <a class="button_crud" href="{{path('app_post_index')}}">Voir l'interface admin !</a>
    {% endif %}
</div>
{% endblock %}
